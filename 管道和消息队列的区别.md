# 管道和消息队列的区别 #

## 管道 ##
管道通信方式的中间介质是文件，通常称这种文件为管道文件。管道分为匿名管道和命名管道。

1. 匿名管道:管道是半双工的，数据只能单向通信；需要双方通信时，需要建立起两个管道；**只能用于父子进程或者兄弟进程之间（具有亲缘关系的进程）**。
2. 命名管道：可在同一台计算机的不同进程之间或在跨越一个网络的不同计算机的不同进程之间，支持可靠的、单向或双向的数据通信。

利用系统调用pipe()创建一个无名管道文件，通常称为无名管道或PIPE；利用系统调用mknod()创建一个命名管道文件，通常称为有名管道或FIFO。
- PIPE是一种非永久性的管道通信机构，当它访问的进程全部终止时，它也将随之被撤消；它也不能用于不同族系的进程之间的通信。
- 而FIFO是一种永久的管道通信机构，它可以弥补PIPE的不足。管道文件被创建后，使用open()将文件进行打开，然后便可对它进行读写操作，通过系统调用write()和read()来实现。通信完毕后，可使用close()将管道文件关闭。
- **匿名管道的文件是内存中的特殊文件，是不可见的**。命名管道的文件是硬盘上的设备文件，是可见的。

## 命名管道FIFO通信为什么能跨越父子进程 ##

命名管道（FIFO）不同于匿名管道（PIPE）之处在于它提供一个路径名与之关联，以FIFO的文件形式存在于文件系统中。这样，即使与FIFO的创建进程不存在亲缘关系的进程，只要可以访问该路径，就能够彼此通过FIFO相互通信（能够访问该路径的进程以及FIFO的创建进程之间），因此，通过FIFO不相关的进程也能交换数据。值得注意的是，FIFO严格遵循先进先出（first in first out），对管道及FIFO的读总是从开始处返回数据，对它们的写则把数据添加到末尾。

## 消息队列 ##
消息队列与命名管道类似，但少了打开和关闭管道方面的复杂性。消息队列提供了一种从一个进程向另一个进程发送一个数据块的方法。**每个数据块被认为含有一个类型**，接收进程可以独立地接收含有不同类型值的数据块。

**优点：**
- 使用类型避免命名管道的同步和阻塞问题

**缺点：**
- 与管道一样，数据块有最大长度的限制

共享内存+信号量的方式效率更高，因为不用将信息多次拷贝（如从进程1拷贝到消息队列，再拷贝到进程2）

